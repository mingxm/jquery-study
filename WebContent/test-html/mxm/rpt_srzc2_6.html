<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<link rel="stylesheet" type="text/css" href="css/rpt_srzc2_6.css">
<link rel="stylesheet" type="text/css" href="css/table.css">
<link rel="stylesheet" type="text/css"
	href="../../js/jquery/download-plugin/jquery-easyui-1.2.2/themes/default/easyui.css">
<script type="text/javascript" src="../../js/jquery/jquery-1.4.4.js"></script>
<script type="text/javascript"
	src="../../js/jquery/download-plugin/jquery-easyui-1.2.2/jquery.easyui.min.js"></script>
<script type="text/javascript"
	src="../../js/jquery/myplugin/mxm/jquery.uploadfile.js"></script>
<script type="text/javascript"
	src="../../js/jquery/myplugin/mxm/jquery.properies.editor.js"></script>
<script type="text/javascript"
	src="../../js/jquery/myplugin/mxm/jquery.table.js"></script>
<script type="text/javascript"
	src="rpt_editor.js"></script>
<script type="text/javascript">
	$(function(){
		var layout = $("body").layout().data("layout");
		var toolbar = $(".coolbar").appendTo(layout.panels["north"]);
		toolbar.find("img").bind("click",function(){
			var fn = $(this).attr("cmd");
			if(fn){
				eval(fn);
			}else {
				alert("没有绑定单击处理函数");
			}
		})
		
		var tableObj = $("<div></div>").addClass("tableContainer").appendTo(layout.panels["center"]);
		tableObj.draggable({containment: "parent"});
		var table = new $.succezBI.jTable({
			renderTo:tableObj
		});
		
		$("li").bind("click",function(e){
			if(e.target != this) return;
			var $this = $(this);
			if($this.hasClass("collapse")){
				$this.removeClass("collapse");
				$this.find(">ul").hide("fast");
				$this.addClass("expand");
			}else if($this.hasClass("expand")){
				$this.removeClass("expand");
				$this.find(">ul").show("slow");
				$this.addClass("collapse");
			}else if($this.children().length == 0){
				$(".selected_node").removeClass("selected_node");
				$this.addClass("selected_node");
			}
		});
		
		$("#components").find(">tbody>tr>td>img").draggable({
			revert:true,
			deltaX:10,
			deltaY:10,
			proxy:function(source){
				var n = $($.succezBI.getDomHtmlByTag($(source).attr("name"))).addClass("proxy").appendTo('body');
				return n;
			}
		});
		
		layout.panels["center"].droppable({
			accept:'img',
			onDrop:function(e,source){
				var d = $($.succezBI.getDomHtmlByTag($(source).attr("name")))
						.css("left",e.pageX).css("top",e.pageY).draggable();;
				$(this).append(d);
			}
		});
		
		layout.panels["east"].jproeditor({
			defaultType:'type',
			items:[
				{
					title:'报表代号',
					type:'edit',
					events:[{
						name:'change',
						fn:function(e){
							var obj = e.data;
							$("#rptid").text(obj.attr("value"));
						}
					}]
				},{
					title:'报表名称',
					type:'edit',
					events:[{
						name:'change',
						fn:function(e){
							var obj = e.data;
							$("#rptnm").text(obj.attr("value"));
						}
					}]
				},{
					title:'隐藏表格',
					type:'checkbox',
					events:[{
						name:'change',
						fn:function(e){
							var obj = e.data;
							$("#showgrid").text(obj.attr("checked")?"是":"否");
						}
					}]
				},{
					title:'报表参数',
					type:'editCanPick',
					align:'center'
				},{
					title:'报表风格',
					type:'combobox',
					options:[{
						caption:'缺省',
						value:'#B6CADD'
					},{
						caption:'橘黄',
						value:'#E0C491'
					},{
						caption:'橘红',
						value:'#DEBDDE'
					},{
						caption:'淡蓝',
						value:'#AFD0A0'
					},{
						caption:'经典',
						value:'#C0C0C0'
					},{
						caption:'红色',
						value:'#FF0000'
					},{
						caption:'绿色',
						value:'00FF00'
					},{
						caption:'蓝色',
						value:'0000FF'
					}],
					events:[{
						name:'change',
						fn:function(e){
							var obj = e.data;
							$("#rptstyle").text(obj.attr("value"));
							$("#resulttable tr td").each(function(index,item){
								$(item).css("border-color",obj.attr("value"));
							});
							$("#resulttable").css("border-color",obj.attr("value"));
						}
					}]
				},{
					title:'每页行数',
					type:'edit',
					events:[{
						name:'change',
						fn:function(e){
							var obj = e.data;
							$("#rows").text(obj.attr("value"))
						}
					}]
				},{
					title:'报表类型',
					type:'radio',
					name:'report_type',
					items:[{
						value:'ana_document',
						caption:'分析报告',
						checked:true
					},{
						value:'ana_report',
						caption:'分析表',
					},{
						caption:'主题表',
						value:'dwsubject',
					}],
					events:[{
						name:'click',
						fn:function(e){
							$("#rpttype").text(e.data.attr("value"));
						}
					}]
				}
			]
		})
		
	})
</script>
<title>Insert title here</title>
</head>
<body class="easyui-layout">
<div region="north" border="false"
	style="height: 30px; background: #B3DFDA;"></div>
<div region="west" split="true" title="West"
	style="width: 150px; padding: 0px;">
<div class="easyui-accordion" fit="true" style="width: 100%">
<div title="报表结构" iconCls="icon-ok"
	style="overflow: auto; padding: 0px;">
<ul id="rptStruct">
	<li class="collapse">报表结构
	<ul>
		<li class="collapse">表头
		<ul>
			<li>HHH0</li>
			<li>HHH1</li>
			<li>HHH2</li>
			<li>HHH3</li>
		</ul>
		</li>
		<li class="collapse">表格
		<ul>
			<li>A1</li>
			<li>A2</li>
			<li>A3</li>
			<li>A4</li>
			<li>A5</li>
			<li>A6</li>
			<li>A7</li>
			<li>A8</li>
			<li>A9</li>
		</ul>
		</li>
		<li class="collapse">参数
		<ul>
			<li>@bbq</li>
			<li>@xzqh</li>
		</ul>
		</li>
		<li class="collapse">统计图
		<ul>
			<li>chart1</li>
			<li>chart2</li>
			<li>chart3</li>
		</ul>
		</li>
		<li class="collapse">其它</li>
	</ul>
	</li>
</ul>
</div>
<div title="控件列表" iconCls="icon-reload" selected="true"
	style="padding: 0px;">
	<table id="components" width="100%">
		<tr>
			<td align="center"><img name="label" src="image/more.gif" title="标签"/></td>
		</tr>
		<tr>
			<td align="center"><img name="edit" src="image/more.gif" title="输入框"/></td>
		</tr>
		<tr>
			<td align="center"><img name="button" src="image/more.gif" title="按钮"/></td>
		</tr>
	</table>
</div>
</div>
</div>
<div region="east" split="true" title="属性列表"
	style="width: 300px; padding: 0px;"></div>
<div region="center" title="报表区域" style="overflow:inherit;"></div>

<table class="coolbar">
	<tr>
		<td><img src="image/more.gif" title="更多" cmd="alert('click')"></img></td>
		<td><img src="image/new.gif"></img></td>
		<td><img src="image/save-d.gif"></img></td>
		<td><img src="image/fixfloat.gif"></img></td>
		<td><img src="image/fixcell2.gif"></img></td>
		<td><img src="image/brush.gif"></img></td>
		<td><img src="image/eraser.gif"></img></td>
		<td><img src="image/fxq.gif"></img></td>
		<td><img src="image/table.gif"></img></td>
		<td><img src="image/clear.gif"></img></td>
	</tr>
</table>
</body>
</html>